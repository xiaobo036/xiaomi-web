import{a as e,k as a,l as s,m as r,j as l,b as t,E as o,f as u,c as n,g as i,h as d}from"./element-plus-DQ9qvSSu.js";import{u as m,b as p}from"./vue-router-Dt9ftvvP.js";import{g as c}from"./path-DAcC9wL_.js";import{d as f,r as g,l as h,j as w,f as v,I as _,J as y,R as x,ah as b,a as j,O as V,al as k,o as I,b as P,c as q,Q as L,a5 as z,D as F,P as U}from"./@vue-CUJ09wQY.js";import{h as C,_ as E}from"./index-nivZnKtY.js";import"./lodash-es-D2DQyxUg.js";import"./@vueuse-C4h3Fq44.js";import"./@element-plus-BYi6I6Re.js";import"./@popperjs-CT_jBSb5.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-XTTl_L6l.js";import"./async-validator-j0i5Y79Y.js";import"./memoize-one-BAtLgO95.js";import"./normalize-wheel-es-TzhA1irr.js";import"./@floating-ui-DoFG930S.js";import"./three-CHkBf3xL.js";/* empty css                    */import"./axios-ei4kQ0Q2.js";const R={class:"form-footer"},N={class:"form-footer"},D=f({name:"Accredit",components:{Login:E(f({__name:"Login",setup(u){const n=g(),i=g(!1),d=h({username:"",password:""}),p={path:"/auth",query:{type:"register"}},c=h({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:50,message:"用户名长度应在3-50个字符之间",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度应在6-20个字符之间",trigger:"blur"}]}),f=m(),P=w(()=>!d.username||!d.password||i.value),q=()=>{var e;null==(e=n.value)||e.clearValidate()},L=async()=>{var e;if(!i.value)try{i.value=!0;if(!(await(null==(e=n.value)?void 0:e.validate())))return void o({type:"error",message:"请填写正确的登录信息",offset:80});200===(await C.post("/auth/login",{username:d.username,password:d.password})).status&&(localStorage.setItem("userName",d.username),localStorage.setItem("userInfo","user was login"),o({type:"success",message:"登录成功",offset:80}),f.push("/shop"))}catch(a){o({type:"error",message:"登录失败，请稍后重试",offset:80})}finally{i.value=!1}};return v(()=>{var e;null==(e=n.value)||e.resetFields()}),(o,u)=>{const m=r,f=s,g=l,h=k("router-link"),w=a,v=t,z=e;return I(),_(z,{gutter:0,class:"login-form"},{default:y(()=>[x(v,{span:24},{default:y(()=>[x(w,{ref_key:"loginFormRef",ref:n,"label-width":"auto",model:d,size:"large",rules:c,onKeyup:b(L,["enter"])},{default:y(()=>[x(f,{prop:"username"},{default:y(()=>[x(m,{type:"text",name:"username",placeholder:"邮箱/手机号码/小米ID",modelValue:d.username,"onUpdate:modelValue":u[0]||(u[0]=e=>d.username=e),"prefix-icon":"User",clearable:"",maxlength:50,onInput:q},null,8,["modelValue"])]),_:1}),x(f,{prop:"password"},{default:y(()=>[x(m,{type:"password",name:"password",placeholder:"密码",modelValue:d.password,"onUpdate:modelValue":u[1]||(u[1]=e=>d.password=e),"prefix-icon":"Lock","show-password":"",maxlength:20,onInput:q},null,8,["modelValue"])]),_:1}),x(f,null,{default:y(()=>[x(g,{type:"primary",class:"submit-btn",onClick:L,loading:i.value,disabled:P.value,color:"#ff6700"},{default:y(()=>[...u[2]||(u[2]=[V("登录",-1)])]),_:1},8,["loading","disabled"])]),_:1}),j("div",R,[x(h,{to:p},{default:y(()=>[...u[3]||(u[3]=[V(" 立即注册 ",-1)])]),_:1}),u[5]||(u[5]=j("span",{class:"divider"},"|",-1)),x(h,{to:"/auth/forgot-password"},{default:y(()=>[...u[4]||(u[4]=[V("忘记密码？",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-92261d57"]]),Register:E(f({__name:"Register",setup(u){const n=g(),i=g(!1),d=h({username:"",password:"",confirmPassword:""}),p={path:"/auth",query:{type:"login"}},c=h({username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度在3-20个字符之间",trigger:"blur"}],password:[{required:!0,validator:(e,a,s)=>{""===a?s(new Error("请输入密码")):a.length<6?s(new Error("密码长度不能小于6位")):s()},trigger:"blur"}],confirmPassword:[{required:!0,validator:(e,a,s)=>{""===a?s(new Error("请再次输入密码")):a!==d.password?s(new Error("两次输入密码不一致")):s()},trigger:"blur"}]}),f=m(),b=w(()=>!d.username||!d.password||!d.confirmPassword||i.value),P=async()=>{if(n.value)try{await n.value.validate(),i.value=!0;const e=await C.post("/auth/register",{username:d.username,password:d.password});200===e.status&&0===e.data.code?(o({type:"success",message:"注册成功",offset:80}),f.push("/auth?type=login")):o({type:"error",message:e.data.message||"注册失败",offset:80})}catch(e){o({type:"error",message:e.message||"注册失败，请检查输入信息",offset:80})}finally{i.value=!1}};return v(()=>{var e;null==(e=n.value)||e.resetFields()}),(o,u)=>{const m=r,f=s,g=l,h=k("router-link"),w=a,v=t,q=e;return I(),_(q,{gutter:0,class:"register-form"},{default:y(()=>[x(v,{span:24},{default:y(()=>[x(w,{ref_key:"registerFormRef",ref:n,"label-width":"auto",model:d,size:"large",rules:c},{default:y(()=>[x(f,{prop:"username"},{default:y(()=>[x(m,{type:"text",name:"username",placeholder:"邮箱/手机号码/小米ID",modelValue:d.username,"onUpdate:modelValue":u[0]||(u[0]=e=>d.username=e),"prefix-icon":"User",clearable:""},null,8,["modelValue"])]),_:1}),x(f,{prop:"password"},{default:y(()=>[x(m,{type:"password",name:"password",placeholder:"密码",modelValue:d.password,"onUpdate:modelValue":u[1]||(u[1]=e=>d.password=e),"prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),x(f,{prop:"confirmPassword"},{default:y(()=>[x(m,{type:"password",name:"confirmPassword",placeholder:"确认密码",modelValue:d.confirmPassword,"onUpdate:modelValue":u[2]||(u[2]=e=>d.confirmPassword=e),"prefix-icon":"Lock","show-password":""},null,8,["modelValue"])]),_:1}),x(f,null,{default:y(()=>[x(g,{type:"primary",class:"submit-btn",onClick:P,color:"#ff6700",loading:i.value,disabled:b.value},{default:y(()=>[...u[3]||(u[3]=[V("立即注册",-1)])]),_:1},8,["loading","disabled"])]),_:1}),j("div",N,[x(h,{to:p},{default:y(()=>[...u[4]||(u[4]=[V(" 已有账号？立即登录 ",-1)])]),_:1})])]),_:1},8,["model","rules"])]),_:1})]),_:1})}}}),[["__scopeId","data-v-2ba03eea"]])},setup(){const e=p(),a=w(()=>e.query.type);return v(()=>{P(()=>{"register"===a.value&&(document.title="小米账号 - 注册")})}),{type:a,navList:[{id:1,name:"用户协议",url:"https://static.account.xiaomi.com/html/agreement/user/zh_CN.html"},{id:2,name:"隐私政策",url:"https://privacy.mi.com/miaccount/zh_CN/"},{id:3,name:"帮助中心",url:"https://cn.account.xiaomi.com/helpcenter?_locale=zh_CN"}],getFullPath:c}}}),S={class:"accredit-container"},A=["href"],B=["href"],J={class:"header-nav-item"},K={class:"header-nav-item"},O={class:"el-dropdown-link"},Q={key:0,class:"login-form"},G={key:1,class:"register-form"};const H=E(D,[["render",function(a,s,r,l,o,m){const p=t,c=k("CaretBottom"),f=n,g=d,h=i,w=u,v=k("Login"),_=k("Register"),b=e;return I(),q("div",S,[x(b,{gutter:0},{default:y(()=>[x(p,{xl:6,lg:6,md:4,sm:0,xs:0},{default:y(()=>[...s[0]||(s[0]=[j("div",{class:"left-container"},null,-1)])]),_:1}),x(p,{xl:18,lg:18,md:24,sm:24,xs:24},{default:y(()=>[x(b,{class:"right-container"},{default:y(()=>[x(p,{xl:12,lg:12,md:16,sm:16,xs:24,class:"header-container"},{default:y(()=>[j("a",{href:a.getFullPath("/#/shop")},[...s[1]||(s[1]=[j("img",{style:{width:"40px",height:"40px"},src:"https://cdn.cnbj1.fds.api.mi-img.com/s02.mifile.cn/assets/static/image/logo-mi2.png",alt:"mi-logo"},null,-1)])],8,A),s[2]||(s[2]=j("div",{class:"mi-title"},"小米账号",-1))]),_:1}),x(p,{xl:12,lg:12,md:16,sm:16,xs:24,class:"header-navlist"},{default:y(()=>[(I(!0),q(L,null,z(a.navList,e=>(I(),q("a",{key:e.id,href:a.getFullPath(e.url)},[j("span",J,U(e.name),1)],8,B))),128)),s[7]||(s[7]=j("span",{class:"header-nav-item"},"|",-1)),j("span",K,[x(w,null,{dropdown:y(()=>[x(h,null,{default:y(()=>[x(g,null,{default:y(()=>[...s[4]||(s[4]=[V("简体中文",-1)])]),_:1}),x(g,null,{default:y(()=>[...s[5]||(s[5]=[V("繁体中文",-1)])]),_:1}),x(g,null,{default:y(()=>[...s[6]||(s[6]=[V("English",-1)])]),_:1})]),_:1})]),default:y(()=>[j("span",O,[s[3]||(s[3]=V(" 语言 ",-1)),x(f,{class:"el-icon--right"},{default:y(()=>[x(c)]),_:1})])]),_:1})])]),_:1}),x(p,{xl:11,lg:11,md:12,sm:16,xs:24,offset:7,style:F(["login"===a.type?{height:"350px"}:{height:"400px"}]),class:"form-container"},{default:y(()=>["login"===a.type?(I(),q("div",Q,[x(v)])):(I(),q("div",G,[x(_)]))]),_:1},8,["style"])]),_:1})]),_:1})]),_:1})])}],["__scopeId","data-v-f359e1f1"]]);export{H as default};
